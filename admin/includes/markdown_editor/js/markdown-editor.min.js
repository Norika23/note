/*!
 * krajee-markdown-editor v1.0.0
 * http://plugins.krajee.com/krajee-markdown-editor
 *
 * Krajee Markdown Editor Main Plugin Library
 *
 * Author: Kartik Visweswaran
 * Copyright: 2014 - 2018, Kartik Visweswaran, Krajee.com
 *
 * Licensed under the BSD 3-Clause
 * https://github.com/kartik-v/krajee-markdown-editor/blob/master/LICENSE.md
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";e.fn.markdownEditorLocales={},e.fn.markdownEditorThemes={};var t,n,o,a,i,r;t={CREDITS:'<a class="text-info" href="http://plugins.krajee.com/markdown-editor">krajee-markdown-editor</a>',CREDITS_MD:"[krajee-markdown-editor](http://plugins.krajee.com/markdown-editor)",BS4_VER:"4.1.1",BS3_VER:"3.3.7",DEFAULT_TIMEOUT:250,EMPTY:"",NAMESPACE:".markdownEditor",LINK_CM:'<a href="http://spec.commonmark.org/" target="_blank">CommonMark</a>',LINK_MI:'<a href="https://markdown-it.github.io/markdown-it/" target="_blank">markdown-it</a>',htmlEncode:function(e){return void 0===e?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},parseHtml:function(e){return void 0===e?"":t.kvUnescape(encodeURIComponent(e))},create:function(n,o){var a=e(document.createElement(n));return t.isEmpty(o)||a.attr(o),a},addCss:function(e,t){t&&e.removeClass(t).addClass(t)},uniqueId:function(){return Math.round((new Date).getTime()+100*Math.random())},isEmpty:function(n,o){return null===n||void 0===n||0===n.length||o&&e.trim(n)===t.EMPTY},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},trimRight:function(e,t){return void 0===t&&(t="s"),e.replace(new RegExp("["+t+"]+$"),"")},getMarkUp:function(e,t,n,o){var a,i,r,s=t.length,l=n.length,d=e,c="",u="",f=!1;return o&&(d=e.replace(/^\s+|\s+$/g,""),d!==e&&(f=!0)),s>0&&(d=d.slice(0,s)===t?d.slice(s):t+d),l>0&&(d=d.slice(-l)===n?d.slice(0,-l):d+n),f&&(c=e.replace(/^\s+/,""),u=e.replace(/\s+$/,""),r=e.length,a=r-c.length,i=u.length,a>0&&(d=e.substring(0,a)+d),i>0&&(d+=e.substring(i,r))),d},getBlockMarkUp:function(n,o,a,i){var r=n,s=[];return r.indexOf("\n")<0?r=t.getMarkUp(n,o,a,i):(s=n.split("\n"),e.each(s,function(e,n){s[e]=t.getMarkUp(t.trimRight(n),o,a+"  ",i)}),r=s.join("\n")),r},setWhitespace:function(e,t){try{e.style.whiteSpace=t}catch(n){}},setSelectionRange:function(n,o,a){var i,r;if(n.setSelectionRange)n.focus(),n.setSelectionRange(o,a),n.scrollTop=0,o>100&&(i=document.createElement("pre"),n.parentNode.appendChild(i),r=window.getComputedStyle(n,""),i.style={visibility:"hidden",lineHeight:r.lineHeight,fontFamily:r.fontFamily,fontSize:r.fontSize,padding:0,border:r.border,outline:r.outline,overflow:"scroll",letterSpacing:r.letterSpacing},t.setWhitespace(i,"-moz-pre-wrap"),t.setWhitespace(i,"-o-pre-wrap"),t.setWhitespace(i,"-pre-wrap"),t.setWhitespace(i,"pre-wrap"),i.textContent=e(n).val().substring(0,o-100),n.scrollTop=i.scrollHeight,i.parentNode.removeChild(i));else if(n.createTextRange){var s=n.createTextRange();s.collapse(!0),s.moveEnd("character",a),s.moveStart("character",o),s.select()}},kvUnescape:function(e){return e.replace(/%([0-9A-F]{2})/gi,function(e,t){return String.fromCharCode(parseInt(t,16))})},handler:function(e,t){e&&e.isDefaultPrevented()||t()},delay:function(){var e=0;return function(n,o){clearTimeout(e),e=setTimeout(n,o||t.DEFAULT_TIMEOUT)}}()},n={click:"click"+t.NAMESPACE,input:"input"+t.NAMESPACE,change:"change"+t.NAMESPACE,focus:"focus"+t.NAMESPACE,blur:"blur"+t.NAMESPACE,keyup:"keyup"+t.NAMESPACE,keydown:"keydown"+t.NAMESPACE,resize:"resize"+t.NAMESPACE,reset:"reset"+t.NAMESPACE,scroll:"scroll"+t.NAMESPACE,touchstart:"touchstart"+t.NAMESPACE,mouseover:"mouseover"+t.NAMESPACE,modalShown:"shown.bs.modal"+t.NAMESPACE,modalHidden:"hidden.bs.modal"+t.NAMESPACE,buttonPress:"buttonPress"+t.NAMESPACE,beforePreview:"beforePreview"+t.NAMESPACE,successPreview:"successPreview"+t.NAMESPACE,emptyPreview:"emptyPreview"+t.NAMESPACE,errorPreview:"errorPreview"+t.NAMESPACE},o={toolbar:{toolbarHeaderL:[["undo","redo"],["bold","italic","ins","del","sup","sub","mark"],["paragraph","newline","heading"],["link","image"],["indent","outdent","ul","ol","dl"],["footnote","blockquote","hr"],["code","codeblock"],["emoji"]],toolbarHeaderR:[["fullscreen"]],toolbarFooterL:[["hint"],["export"]],toolbarFooterR:[["mode"]]},templates:{main:'<div class="md-editor" tabindex="0">\n  {HEADER}\n  <table class="md-input-preview">\n    <tr>\n      <td class="md-input-cell">{INPUT}</td>\n      <td class="md-preview-cell">{PREVIEW}</td>\n    </tr>  </table>\n  {FOOTER}\n  {DIALOG}\n</div>',header:'<div class="md-header">\n  <div class="md-toolbar-header-r pull-right float-right">\n    {TOOLBAR_HEADER_R}\n  </div>\n  <div class="md-toolbar-header-l">\n    {TOOLBAR_HEADER_L}\n  </div>\n  <div class="clearfix">\n  </div>\n</div>',preview:'<div class="md-preview" tabindex="0">\n</div>',footer:'<div class="md-footer">\n  <div class="md-toolbar-footer-r pull-right float-right">\n    {TOOLBAR_FOOTER_R}\n  </div>\n  <div class="md-toolbar-footer-l">\n    {TOOLBAR_FOOTER_L}\n  </div>\n  <div class="clearfix">\n  </div>\n</div>',dialog:'<div class="md-dialog modal fade" tabindex="-1" role="dialog">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n         {HEADER}\n      </div>\n      <div class="modal-body">\n        <input class="md-dialog-input form-control">\n        <input class="md-dialog-title form-control">\n        <div class="md-dialog-content"></div>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="md-dialog-cancel btn btn-default btn-outline-secondary" data-dismiss="modal">\n          {DIALOG_CANCEL_ICON} {DIALOG_CANCEL_TEXT}\n        </button>\n        <button type="button" class="md-dialog-submit btn btn-primary" data-dismiss="modal">\n          {DIALOG_SUBMIT_ICON} {DIALOG_SUBMIT_TEXT}\n        </button>\n      </div>\n    </div>\n</div>',dialogClose:'<button type="button" class="close" data-dismiss="modal" aria-label="Close">\n  <span aria-hidden="true">&times;</span>\n</button>\n',htmlMeta:'<!DOCTYPE html>\n  <meta http-equiv="Content-Type" content="text/html,charset=UTF-8"/>\n  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>\n',exportCssJs:"{EXPORT_PREPEND_CSS_JS}\n<style>\n  body{margin:20px;padding:20px;border:1px solid #ddd;border-radius:5px;}\n  .md-codeblock{padding:5px 8px;background-color:#f5f5f5;border:1px solid #ddd;border-radius:0}\n  .md-blockquote{border-left:5px solid #eee;padding: 10px 20px}\n  .md-line img{max-width:100%}\n</style>",exportHeader:"> - - -\n> Markdown Export\n> ==============\n> *Generated {TODAY} by {CREDITS}*\n> - - -\n\n",hint:"<ul>\n  <li><p>You may follow the {LINK_CM} specification (generated via {LINK_MI} plugin) for writing your markdown text.</p></li>\n  <li><p>In order to use the formatting buttons on the toolbar, you generally need to highlight a text   within the editor on which the formatting is to be applied. You can also undo the format action on the   highlighted text by clicking the button again (for most buttons).</p></li>\n  <li><p>Keyboard access shortcuts for buttons:</p>    {ACCESS_KEYS}  </li>\n</ul>"},icons:{undo:'<span class="fas fa-fw fa-undo"></span>',redo:'<span class="fas fa-fw fa-redo"></span>',bold:'<span class="fas fa-fw fa-bold"></span>',italic:'<span class="fas fa-fw fa-italic"></span>',ins:'<span class="fas fa-fw fa-underline"></span>',del:'<span class="fas fa-fw fa-strikethrough"></span>',sup:'<span class="fas fa-fw fa-superscript"></span>',sub:'<span class="fas fa-fw fa-subscript"></span>',mark:'<span class="fas fa-fw fa-eraser"></span>',paragraph:'<span class="fas fa-fw fa-paragraph"></span>',newline:'<span class="fas fa-fw fa-text-height"></span>',heading:'<span class="fas fa-fw fa-heading"></span>',link:'<span class="fas fa-fw fa-link"></span>',image:'<span class="far fa-fw fa-image"></span>',indent:'<span class="fas fa-fw fa-indent"></span>',outdent:'<span class="fas fa-fw fa-outdent"></span>',ul:'<span class="fas fa-fw fa-list-ul"></span>',ol:'<span class="fas fa-fw fa-list-ol"></span>',dl:'<span class="fas fa-fw fa-th-list"></span>',footnote:'<span class="far fa-fw fa-sticky-note"></span>',blockquote:'<span class="fas fa-fw fa-quote-right"></span>',code:'<span class="fas fa-fw fa-code"></span>',codeblock:'<span class="far fa-fw fa-file-code"></span>',hr:'<span class="fas fa-fw fa-minus"></span>',emoji:'<span class="far fa-fw fa-smile"></span>',fullscreen:'<span class="fas fa-fw fa-arrows-alt"></span>',minscreen:'<span class="fas fa-fw fa-compress"></span>',hint:'<span class="fas fa-fw fa-lightbulb"></span>',modePreview:'<span class="fas fa-fw fa-search"></span>',modeEditor:'<span class="fas fa-fw fa-edit"></span>',modeSplit:'<span class="fas fa-fw fa-arrows-alt-h"></span>',"export":'<span class="fas fa-fw fa-download"></span>',exportHtml:'<span class="fas fa-fw fa-file-alt"></span>',exportText:'<span class="fas fa-fw fa-file"></span>',alertMsg:'<span class="fas fa-fw fa-exclamation-circle"></span>',dialogCancel:'<span class="fas fa-fw fa-times"></span>',dialogSubmit:'<span class="fas fa-fw fa-check"></span>'},buttonAccessKeys:{undo:"z",redo:"y",bold:"b",italic:"i",ins:"u",del:"x",sup:"^",sub:"~",mark:"=",paragraph:"#",newline:"0",heading1:"1",heading2:"2",heading3:"3",heading4:"4",heading5:"5",heading6:"6",link:"l",image:"p",indent:">",outdent:"<",ul:"*",ol:"9",dl:"+",footnote:"n",blockquote:"q",code:"j",codeblock:"k",hr:"-",emoji:":",fullscreen:".",hint:"?",modeEditor:"(",modePreview:")",modeSplit:"_",exportHtml:"h",exportText:"t"},buttonTitles:{undo:"Undo",redo:"Redo",bold:"Bold",italic:"Italic",ins:"Underline / Inserted Text",del:"Strike Through",sup:"Superscript",sub:"Subscript",mark:"Highlighted Text",paragraph:"Paragraph",newline:"Append line break",heading:"Heading",link:"Hyperlink",image:"Image Link",indent:"Indent Text",outdent:"Outdent Text",ul:"Unordered List",ol:"Ordered List",dl:"Definition List",footnote:"Footnote",blockquote:"Block Quote",code:"Inline Code",codeblock:"Code Block",hr:"Horizontal Line",emoji:"Emojis / Emoticons",fullscreen:"Toggle full screen mode",hint:"Usage Hints",modeEditor:"Editor mode",modePreview:"Preview mode",modeSplit:"Split mode","export":"Export content",exportHtml:"Export as HTML",exportText:"Export as Text"},buttonCss:{hint:"btn btn-info"},dropdownCss:{emoji:"md-emojies-list pull-right float-right"},buttonLabels:{"export":"Export",exportHtml:"HTML",exportText:"Text"},buttonPrompts:{link:{header:"Insert Hyperlink",hintInput:"Enter hyperlink address...",hintTitle:"Enter text for the link..."},image:{header:"Insert Image Link",hintInput:"Enter image link address...",hintTitle:"Enter alternate text for the image..."},ol:{header:"Ordered List Starting Number",hintInput:"Integer starting from 1"},codeblock:{header:"Enter code language",hintInput:"e.g. html, php, js"}},buttonActions:{bold:{before:"**",after:"**","default":"**(bold text here)**",skipSpaces:!0},italic:{before:"_",after:"_","default":"_(italic text here)_",skipSpaces:!0},ins:{before:"++",after:"++","default":"_(inserted text here)_",skipSpaces:!0},del:{before:"~~",after:"~~","default":"_(strikethrough text here)_",skipSpaces:!0},mark:{before:"==",after:"==","default":"_(marked text here)_",skipSpaces:!0},sup:{before:"^",after:"^","default":"_(superscript text here)_",skipSpaces:!0},sub:{before:"~",after:"~","default":"_(subscript text here)_",skipSpaces:!0},paragraph:{before:"\n",after:"\n","default":"\n(paragraph text here)\n",inline:!0},newline:{before:t.EMPTY,after:"  "},heading1:{before:"# ","default":"# (heading 1 text here)",inline:!0},heading2:{before:"## ","default":"## (heading 2 text here)",inline:!0},heading3:{before:"### ","default":"### (heading 3 text here)",inline:!0},heading4:{before:"#### ","default":"#### (heading 4 text here)",inline:!0},heading5:{before:"##### ","default":"##### (heading 5 text here)",inline:!0},heading6:{before:"###### ","default":"###### (heading 6 text here)",inline:!0},indent:function(t){var n,o="  ";return t.indexOf("\n")<0?t=o+t:(n=t.split("\n"),e.each(n,function(e,t){n[e]=o+t}),t=n.join("\n")),t},outdent:function(t){var n,o="  ";return t.indexOf("\n")<0&&t.substr(0,2)===o?t=t.slice(2):(n=t.split("\n"),e.each(n,function(e,t){n[e]=t,t.substr(0,2)===o&&(n[e]=t.slice(2))}),t=n.join("\n")),t},link:function(e){return function(n,o){return t.isEmpty(n)||("ftp://"!==n.substring(0,6)&&"http://"!==n.substring(0,7)&&"https://"!==n.substring(0,8)&&(n="http://"+n),e="["+o+"]("+n+")"),e}},image:function(e){return function(n,o){return t.isEmpty(n)||("ftp://"!==n.substring(0,6)&&"http://"!==n.substring(0,7)&&"https://"!==n.substring(0,8)&&(n="http://"+n),e="!["+o+"]("+n+")"),e}},ul:{before:"- ",after:t.EMPTY},ol:function(n){var o,a;return function(i){return t.isEmpty(i)?t.EMPTY:(t.isNumber(i)||(i=1),n.indexOf("\n")<0?n=t.getMarkUp(n,i+". ",t.EMPTY):(o=parseInt(i),a=n.split("\n"),e.each(a,function(e,n){a[e]=t.getMarkUp(n,o+". ",t.EMPTY),o++}),n=a.join("\n")),n)}},dl:function(n){var o,a,i;return n.indexOf("\n")>0?(o=1,i=n.split("\n"),e.each(i,function(e,n){a=o%2===0?":    ":t.EMPTY,i[e]=t.getMarkUp(n,a,t.EMPTY),o++}),n=i.join("\n")):n+="\n:    \n",n},footnote:function(n){var o,a,i,r="Enter footnote ",s=t.EMPTY;return n.indexOf("\n")<0?(s="[^1]: "+r+"1\n",n=t.getMarkUp(n,t.EMPTY,r+"[^1]")+"\n"+s):(o=1,i=n.split("\n"),e.each(i,function(e,n){a="[^"+o+"]",i[e]=t.getMarkUp(n,t.EMPTY,a+"  "),s=s+a+": "+r+o+"\n",o++}),n=i.join("\n")+"  \n\n"+s),n},blockquote:{before:"> ",after:"  "},code:{before:"`",after:"`",inline:!0},codeblock:function(e){return function(n){return t.isEmpty(n,!0)&&(n=t.EMPTY),t.getMarkUp(e,"~~~"+n+" \n","\n~~~  \n")}},hr:{before:t.EMPTY,after:"\n- - -",inline:!0}},exportConfig:{exportText:{ext:"txt",uri:"data:text/plain;base64,"},exportHtml:{ext:"htm",uri:"data:text/html;base64,"}}},a=function(){this.init()},a.prototype={constructor:a,init:function(){var e=this;e.commands=[],e.stackPosition=-1,e.savePosition=-1},execute:function(e){var t=this;t._clearRedo(),e.execute(),t.commands.push(e),t.stackPosition++,t.changed()},undo:function(){var e=this;e.commands[e.stackPosition].undo(),e.stackPosition--,e.changed()},canUndo:function(){var e=this;return e.stackPosition>=0},redo:function(){var e=this;e.stackPosition++,e.commands[e.stackPosition].redo(),e.changed()},canRedo:function(){var e=this;return e.stackPosition<e.commands.length-1},save:function(){var e=this;e.savePosition=e.stackPosition,e.changed()},dirty:function(){var e=this;return e.stackPosition!==e.savePosition},_clearRedo:function(){var e=this;e.commands=e.commands.slice(0,e.stackPosition+1)},changed:function(){}},i=function(e,t,n,o,a){var i=this;i.textarea=e,i.oldValue=t,i.newValue=n,i.oldPos=o,i.newPos=a},i.prototype={constructor:i,execute:function(){},undo:function(){var e=this,n=e.textarea,o=n[0];n.val(e.oldValue),t.setSelectionRange(o,e.oldPos[0],e.oldPos[1])},redo:function(){var e=this,n=e.textarea,o=n[0];n.val(e.newValue),t.setSelectionRange(o,e.newPos[0],e.newPos[1])}},r=function(t,n){var o=this;o.$element=e(t),o.init(n)},r.prototype={constructor:r,init:function(n){var o=this,a=o.$element;e.each(n,function(e,t){o[e]=t}),o.initToolbar(),o.isDisabled=a.attr("disabled")||a.attr("readonly"),a.attr("id")||a.attr("id",t.uniqueId()),o.isBs4="4"===String(o.bsVersion).substring(0,1),void 0===o.exportPrependCssJs&&(o.exportPrependCssJs='<link href="https://maxcdn.bootstrapcdn.com/bootstrap/'+(o.isBs4?t.BS4_VER:t.BS3_VER)+'/css/bootstrap.min.css" rel="stylesheet">'),o.setDefaults("icons"),o.setDefaults("buttonTitles"),o.setDefaults("buttonLabels"),o.setDefaults("buttonPrompts"),o.setDefaults("buttonAccessKeys"),o.setDefaults("buttonActions"),o.setDefaults("buttonCss"),o.setDefaults("buttonGroupCss"),o.setDefaults("dropdownCss"),o.setDefaults("exportConfig"),o.setDefaults("templates"),o.defaultInputHeight=a.height(),o.enableSplitMode&&void 0===o.enableLivePreview&&(o.enableLivePreview=!0),o.render(),o.$preview.height(o.defaultInputHeight),a.height(o.defaultInputHeight),o.startFullScreen&&o.toggleFullScreen(),o.initLibrary(),o.reset(),o.listen()},getLibrary:function(){return this._library||null},initLibrary:function(){var n,o=this;return window.markdownit?(n=o._library=window.markdownit(o.markdownItOptions),e.each(o.markdownItPlugins,function(e,t){window[e]&&n.use(window[e],t)}),t.isEmpty(o.markdownItDisabledRules)||n.disable(o.markdownItDisabledRules),void(t.isEmpty(o.parserUrl)&&void 0===o.parserMethod&&(o.parserMethod=function(e){return n.renderer.rules.emoji=function(e,t){return o.useTwemoji&&window.twemoji?window.twemoji.parse(e[t].content):'<span class="md-emoji">'+e[t].content+"</span>"},n.renderer.rules.paragraph_open=n.renderer.rules.heading_open=function(e,t,n,o,a){var i;return e[t].map&&0===e[t].level&&(i=e[t].map[0],e[t].attrJoin("class","md-line"),e[t].attrSet("data-line",String(i))),a.renderToken(e,t,n,o,a)},n.render(e)}))):void(console&&"function"==typeof console.log&&console.log("INIT LIBRARY ERROR: Markdown IT Library not found or not loaded."))},setDefaults:function(t){var n=this;"function"!=typeof n[t]&&(n[t]=e.extend(!0,{},o[t]||{},n[t]))},getConfig:function(t,n){var o,a=this,i=a[t],r=a.theme&&e.fn.markdownEditorThemes[a.theme]||{};return void 0===i?null:(o=r[t],"function"==typeof o?o(n):"function"==typeof i?i(n):i[n])},handleEvent:function(n,o,a){var i=this,r=o+t.NAMESPACE;n.off(r).on(r,e.proxy(i[a],i))},listen:function(){var t=this,o=t.$container,a=t.$element,i=t.$preview,r=a.closest("form"),s=n.resize,l=n.reset,d=n.keyup,c=n.buttonPress,u=n.focus,f=n.blur,p=n.change,m=n.click,h=n.touchstart+" "+n.mouseover,g=t.$editor.find(".md-emoji-search"),v=n.keydown;t.parseButtons(),o.find(".dropdown-toggle").dropdown(),t.handleEvent(t.$dialog,v,"keydownDialog"),t.handleEvent(a,u,"focus"),t.handleEvent(i,u,"focus"),t.handleEvent(a,f,"blur"),t.handleEvent(i,f,"blur"),t.handleEvent(e(document),v,"escapeFullScreen"),t.handleEvent(e(window),s,"resizeWindow"),r.length&&t.handleEvent(r,l,"reset"),t.handleEvent(t.$btnUndo,m,"undo"),t.handleEvent(t.$btnRedo,m,"redo"),t.handleEvent(a,d,"keyup"),t.handleEvent(a,c,"buttonPress"),t.handleEvent(a,h,"mouseoverEditor"),t.handleEvent(i,h,"mouseoverPreview"),t.handleEvent(t.$modeInput,p,"changeMode"),g.length&&(t.handleEvent(g.find("input"),d,"emojiSearch"),t.handleEvent(g.find(".md-close"),m,"emojiSearchClose"))},resizeWindow:function(n){var o,a,i=this,r=i.$container,s=i.$preview;t.handler(n,function(){r.hasClass("md-fullscreen-overlay")&&i.resizeFullScreen(),o=s.find(".md-preview-message"),o.length&&(a=e(window).width()<640?"100%":.5*s.width(),o.width(a))})},emojiSearch:function(n){var o=this,a=o.$editor.find(".md-emoji-search"),i=a.find("input"),r=i.val(),s=a.closest("ul");t.handler(n,function(){t.delay(function(){s.find("li").each(function(){var t=e(this),n=t.find("a").attr("data-key");t.hasClass("md-emoji-search")||n&&-1!==n.indexOf(r)?t.show():t.hide()})})})},emojiSearchClose:function(e){var n=this,o=n.$editor.find(".md-emoji-search");t.handler(e,function(){e.stopPropagation(),o.closest("ul").find("li").show(),o.find("input").val("")})},focus:function(e){var n=this;t.handler(e,function(){t.addCss(n.$editor,"active")})},blur:function(e){var n=this;t.handler(e,function(){n.$editor.removeClass("active")})},clickButton:function(e,n){var o,a,i=this,r=n.data("key"),s=n.hasClass("md-btn-heading"),l=n.hasClass("md-btn-export"),d=n.hasClass("md-btn-emoji");t.handler(e,function(){if(i.isDisabled&&!i.isPreviewModeButton(r))return!1;if(s||l||d){if(e.preventDefault(),l&&i.raise("clickExport",[r]))return void i.exportData(r);if(d&&i.raise("clickEmoji",[r,":"+r+":"]))return void i.replaceSelected(":"+r+":")}switch(r){case"fullscreen":i.toggleFullScreen();break;case"hint":o=i.getTitle(r)+" <small>"+t.CREDITS+"</small>",i.showPopup(o,i.renderHint(),!0);break;default:a=i.process(r),i.raise("clickButton",[r,a])&&!t.isEmpty(a)&&i.replaceSelected(a)}})},changeMode:function(e){var n,o,a=this;t.handler(e,function(){n=a.$mode.find('input:radio[name="mdMode"]:checked').val()||"modeEditor",o=n.substr(4).toLowerCase(),a.raise("changeMode",[o])&&(a.toggleMode(n),a.currentMode=o)})},reset:function(e){var n=this,o=n.$element,a=o[0];t.handler(e,function(){setTimeout(function(){n.enableUndoRedo?(n.undoStack=n.resetUndoStack(),n.startValue=o.val(),n.startPos=[a.selectionStart,a.selectionEnd]):n.undoStack=null,n.$preview.is(":visible")&&setTimeout(function(){n.generatePreview()},1)},1)})},undo:function(e){var n=this;n.enableUndoRedo&&n.raise("undo",[n.undoStack])&&t.handler(e,function(){n.undoStack.undo(),n.scrollMap=null,n.enableLivePreview&&n.generatePreview()})},redo:function(e){var n=this;n.enableUndoRedo&&n.raise("undo",[n.undoStack])&&t.handler(e,function(){n.undoStack.redo(),n.scrollMap=null,n.enableLivePreview&&n.generatePreview()})},keyup:function(e){var n=this,o=n.$element,a=o[0],r=n.undoStack;t.handler(e,function(){n.enableLivePreview&&n.$preview.is(":visible")&&t.delay(n.generatePreview()),n.enableUndoRedo&&t.delay(function(){var e=o.val(),t=[a.selectionEnd,a.selectionEnd];e!==n.startValue&&(r.execute(new i(o,n.startValue,e,n.startPos,t)),n.startValue=e,n.startPos=t,n.scrollMap=null)})})},keydownDialog:function(n){var o=this;t.handler(n,function(){var t=e(n.target),a=t.hasClass("md-dialog-input"),i=t.hasClass("md-dialog-title");13===n.keyCode&&(a||i)&&(n.stopPropagation(),n.preventDefault(),!i&&o.$dialogTitle.is(":visible")||o.$dialogSubmit.trigger("click"))})},buttonPress:function(e,n,o){var a,r=this,s=r.$element;t.handler(e,function(){r.isDisabled||(r.enableUndoRedo&&(a=s.val(),r.startPos=n,r.undoStack.execute(new i(s,r.startValue,a,r.startPos,o)),r.startValue=a,r.startPos=o),r.enableLivePreview&&r.$preview.is(":visible")&&r.generatePreview())})},_mouseover:function(e,t){var o=this,a=o.$element,i=o.$preview,r=n.scroll;e&&e.isDefaultPrevented()||!a.is(":visible")||!i.is(":visible")||("editor"===t?(i.off(r),a.on(r,function(){o.syncPreviewScroll()})):(a.off(r),i.on(r,function(){o.syncInputScroll()})))},mouseoverEditor:function(e){var n=this;t.handler(e,function(){n._mouseover(e,"editor")})},mouseoverPreview:function(e){var n=this;t.handler(e,function(){n._mouseover(e,"preview")})},buildScrollMap:function(){var n,o,a,i,r,s,l,d=this,c=d.$element,u=d.$preview,f=0,p=[],m=[],h=[];if(!d.enableScrollSync)return"";for(l=t.create("div").css({position:"absolute",visibility:"hidden",height:"auto",width:c[0].clientWidth,"font-size":c.css("font-size"),"font-family":c.css("font-family"),"line-height":c.css("line-height"),"white-space":c.css("white-space")}).appendTo("body"),o=u[0].scrollTop-u.offset().top,c.val().split("\n").forEach(function(e){var t,n;return p.push(f),0===e.length?void f++:(l.text(e),t=parseFloat(l.css("height")),n=parseFloat(l.css("line-height")),void(f+=Math.round(t/n)))}),l.remove(),p.push(f),s=f,n=0;s>n;n++)h.push(-1);for(m.push(0),h[0]=0,u.find(".md-line").each(function(t,n){var a=e(n),i=a.data("line");""!==i&&(i=p[i],0!==i&&m.push(i),h[i]=Math.round(a.offset().top+o))}),m.push(s),h[s]=u[0].scrollHeight,a=0,n=1;s>n;n++)-1===h[n]?(i=m[a],r=m[a+1],h[n]=Math.round((h[r]*(n-i)+h[i]*(r-n))/(r-i))):a++;return h},syncInputScroll:function(){var e,t,n,o=this,a=o.$element,i=o.$preview,r=o.scrollMap,s=i[0].scrollTop,l=parseFloat(a.css("line-height"));if(r||(r=o.scrollMap=o.buildScrollMap()),e=Object.keys(r),!(e.length<1)){for(n=e[0],t=1;t<e.length&&r[e[t]]<s;t++)n=e[t];a.stop(!0).animate({scrollTop:l*n},100,"linear")}},syncPreviewScroll:function(){var e,t=this,n=t.$element,o=t.$preview,a=t.scrollMap,i=parseFloat(n.css("line-height")),r=Math.floor(n[0].scrollTop/i);a||(a=t.scrollMap=t.buildScrollMap()),e=a[r],o.stop(!0).animate({scrollTop:e},100,"linear")},isPreviewModeButton:function(e){var t=this;return-1!==t.previewModeButtons.indexOf(e)},resetUndoStack:function(){var e=this,t=new a;return e.startValue=e.$element.val(),e.startPos=[0,0],t.changed=function(){e.disableButton(e.$btnUndo,!t.canUndo()),e.disableButton(e.$btnRedo,!t.canRedo())},t.changed(),t},parseButtons:function(){var t=this,o=t.$container,a=n.click;o.find(".md-btn,.md-btn-heading,.md-btn-export,.md-btn-emoji").each(function(){var n=e(this);n.off(a).on(a,function(e){t.clickButton(e,n)})})},getSelected:function(){var e=this,t=e.$element,n=t.val(),o=t[0];return n.substring(o.selectionStart,o.selectionEnd)},replaceSelected:function(e){var o=this,a=o.$element,i=a.val(),r=a[0],s=r.selectionStart,l=e.length,d=r.selectionEnd,c=i.substring(0,s)+e+i.substring(d),u=s+l;a.val(c).trigger(n.buttonPress,[[s,d],[s,u]]),t.setSelectionRange(r,s,u)},destroy:function(){var n=this,o=n.$element,a=n.$container,i=n.inputCss,r=t.NAMESPACE;i&&o.removeClass(i).show(),o.off(r),e(window).off(r),e(document).off(r),a.before(o).remove()},getLayout:function(e){var n,o,a,i,r=this,s=r.getConfig("templates",e)||t.EMPTY;return"dialog"===e&&(i=r.isBs4?"h5":"h4",o="<"+i+' class="md-dialog-head-title modal-title"></'+i+">",a=r.getConfig("templates","dialogClose"),n=r.isBs4?o+"\n"+a:a+"\n"+o,s=s.replace("{HEADER}",n).replace("{DIALOG_CANCEL_ICON}",r.renderIcon("dialogCancel")).replace("{DIALOG_SUBMIT_ICON}",r.renderIcon("dialogSubmit")).replace("{DIALOG_CANCEL_TEXT}",r.dialogCancelText).replace("{DIALOG_SUBMIT_TEXT}",r.dialogSubmitText)),s},submitExportForm:function(n,o){var a,i,r,s=this,l=t.create("form"),d=s.$element.attr("id")+"-iframe",c=s.exportUrlAddlData;e("#"+d).length||t.create("iframe",{id:d,name:d,css:{display:"none"}}).appendTo("body"),a=t.create("input",{type:"hidden",name:"export_type",value:n}),i=t.create("input",{type:"hidden",name:"export_filename",value:s.exportFileName}),r=t.create("input",{name:"export_content",css:{display:"none"}}).val(o||s.noDataMsg),l.attr({target:d,action:s.exportUrl,method:s.exportUrlMethod}),l.append(a,i,r),c&&l.append("function"==typeof c?c():c),l.appendTo("body").hide().submit().remove()},showPopup:function(e,t,o){var a=this,i=n.modalShown;a.$dialogMain.removeClass("modal-lg"),o&&a.$dialogMain.addClass("modal-lg"),a.$dialogHeadTitle.html(e),a.$dialogContent.html(t).show(),a.$dialogInput.hide(),a.$dialogTitle.hide(),a.$dialogClose.show(),a.$dialogHeader.show(),a.$dialogFooter.hide(),a.$dialogSubmit.off(n.click),a.$dialog.modal("show"),a.$dialog.off(i).on(i,function(){a.$dialogClose.focus(),a.$dialog.off(i)})},showDialog:function(e,o,a){var i=this,r=i.getConfig("buttonPrompts",e),s=r.header||t.EMPTY,l=i.renderIcon(e),d=r.hintInput||t.EMPTY,c=r.hintTitle,u=n.modalShown,f=n.click;i.$dialogMain.removeClass("modal-lg"),i.$dialogHeadTitle.html(l?l+" "+s:s),i.$dialogContent.hide(),i.$dialogTitle.hide().val(a||t.EMPTY),i.$dialogClose.show(),i.$dialogHeader.show(),i.$dialogFooter.show(),i.$dialogInput.show().val(t.EMPTY).attr("placeholder",d),c&&!a&&i.$dialogTitle.show().attr("placeholder",c),i.$dialogSubmit.off(f).on(f,function(){var e=o(i.$dialogInput.val(),i.$dialogTitle.val());t.isEmpty(e)||i.replaceSelected(e)}),i.$dialog.modal("show"),i.$dialog.off(u).on(u,function(){i.$dialogInput.focus(),i.$dialog.off(u)})},raise:function(n,o,a){var i=this,r=e.Event(n+t.NAMESPACE);return a=a||i.$element,o?a.trigger(r,o):a.trigger(r),!r.isDefaultPrevented()||r.result===!1},showPreviewMsg:function(e){var t=this,n=t.$preview,o=t.getAlert(e,t.previewErrorTitle);n.html('<div class="md-preview-message">'+o+"</div>"),n.find(".md-preview-message").width(.5*n.width()),n.find(".md-alert").hide().fadeIn("slow")},disableButton:function(e,t){t?e.attr("disabled",!0):e.removeAttr("disabled")},hasInvalidConfig:function(e){var n=this,o=n[e+"Url"],a="export"===e?"exportUrlMethod":e+"Method",i=n[a],r=t.isEmpty(o),s=t.isEmpty(i),l=typeof i;return r&&s||!s&&"function"!==l&&"object"!==l},parseOutput:function(t){var n=this,o=n.postProcess;return o&&("function"==typeof o?t=o(t):"object"==typeof o&&e.each(o,function(e,n){e!==n&&(t=t.split(e).join(n))})),t},getPureHtml:function(e){var t=this;return t.purifyHtml&&window.DOMPurify?window.DOMPurify.sanitize(e):e},getHtml:function(e){var n=this,o=n.$element,a=n.parserMethod;return void 0===e&&(e=o.val()),t.isEmpty(n.parserUrl)?(e="function"==typeof a?a(e):new a(e),e=n.parseOutput(e),n.getPureHtml(e)):(n._ajaxSubmit(e),null)},generatePreview:function(e,t){var n=this,o=n.getHtml(e);return t?o:void n.$preview.html(o)},output:function(){var e,o=this,a=o.$element,i=o.$preview,r=a.val(),s=!0,l=0,d=n.successPreview,c=n.emptyPreview+" "+n.errorPreview;if(t.isEmpty(r)||o.hasInvalidConfig("parser"))return t.EMPTY;if(e=o.generatePreview(r,!0),t.isEmpty(o.parserUrl))return e;for(;s&&l<o.outputParseTimeout;)t.delay(function(){a.off(d).on(d,function(){s=!1,e=i.html()}).off(c).on(c,function(){s=!1,e=""}),l+=150},150);return e},toggleMode:function(e){var n,o=this,a=o.$element,i=a.val(),r=o.$container,s=o.currentMode||"modeEditor",l=r.find(".md-input-preview"),d=function(){"editor"===s&&(o.$preview.html(o.getProgress(o.loadingMsg)),setTimeout(function(){o.generatePreview(),o.$mode.focus()},50))};switch((t.isEmpty(i)||o.hasInvalidConfig("parser"))&&(n=t.isEmpty(i)?o.noDataMsg:o.noPreviewUrlMsg,o.showPopupAlert(o.getTitle("mode"),n,"errorToggleMode",[o.$modeInput.val()])),r.removeClass("md-only-preview"),l.removeClass("md-editor-mode md-preview-mode md-split-mode"),e){case"modeEditor":t.addCss(l,"md-editor-mode");break;case"modePreview":t.addCss(l,"md-preview-mode"),t.addCss(r,"md-only-preview"),d();break;case"modeSplit":t.addCss(l,"md-split-mode"),d()}},toggleFullScreen:function(){var e=this,t=e.$container,n=e.$element,o=e.$preview;t.hasClass("md-fullscreen-overlay")?e.raise("normalScreen")&&(t.removeClass("md-fullscreen-overlay"),n.height(e.defaultInputHeight),o.height(e.defaultInputHeight)):e.raise("fullScreen")&&(t.addClass("md-fullscreen-overlay"),e.resizeFullScreen()),o.is(":visible")?o.focus():n.focus()},escapeFullScreen:function(e){var t=this;t.enableEscKeyFullScreen&&t.$container.hasClass("md-fullscreen-overlay")&&27==e.keyCode&&t.toggleFullScreen()},resizeFullScreen:function(){var t=this,n=t.$container,o=t.$element,a=n.find(".md-header"),i=n.find(".md-footer"),r=e(window).height()-a.outerHeight(!0)-i.outerHeight(!0)-(o.outerHeight(!0)-o.height());o.height(r),t.$preview.height(r)},process:function(e){var n,o,a,i,r,s=this,l=s.$element,d=s.getSelected(),c=d.length,u=s.getConfig("buttonActions",e);return"mode"!==e&&"export"!==e.substring(0,6)&&l.focus(),"undo"===e||"redo"===e?"":u?"function"==typeof u?(n=u(d),"function"==typeof n?(s.showDialog(e,n,d),t.EMPTY):n):"object"!=typeof u||void 0===u.before&&void 0===u.after?t.EMPTY:(a=t.isEmpty(u.before)?t.EMPTY:u.before,i=t.isEmpty(u.after)?t.EMPTY:u.after,o=u["default"],r=u.skipSpaces,n=u.inline?t.getMarkUp(d,a,i,r):t.getBlockMarkUp(d,a,i,r),o?c>0?n:o:n):t.EMPTY},download:function(e,n){var o,a=this,i=a.getConfig("exportConfig",e),r=i.ext||"",s=i.uri||"";return t.isEmpty(a.exportUrl)?(s+=window.btoa(n),o=t.create("a",{href:s,download:a.getFileName(e)}).appendTo("body"),o[0].click(),void o.remove()):void a.submitExportForm(r,n)},getLabel:function(e){var n=this;return n.renderIcon(e)+" "+(n.getConfig("buttonLabels",e)||t.EMPTY)},getTitle:function(e){var n=this;return n.renderIcon(e)+" "+(n.getConfig("buttonTitles",e)||t.EMPTY)},getProgress:function(e){return'<div class="md-loading">'+e+"</div>"},getAlert:function(e,t,n){var o=this;return t=t?"<h4>"+(n?"":o.renderIcon("alertMsg"))+t+"</h4>":"",'<div class="'+o.alertMsgCss+' md-alert">'+t+e+"</div>"},showPopupAlert:function(e,t,o,a){var i=this,r=i.$dialog.find(".modal-body"),s=i.alertFadeDuration,l=n.modalShown,d=n.modalHidden;i.showAlerts&&(i.showPopup("",i.getAlert(t,e,!0)),i.$dialogHeader.hide(),i.$dialogFooter.hide(),i.$dialogClose.hide(),r.addClass("md-zero-pad"),i.$dialog.off(l).on(l,function(){s?setTimeout(function(){i.$dialog.modal("hide").off(l)},s):i.$dialog.modal("hide").off(l)}),i.$dialog.off(d).on(d,function(){r.removeClass("md-zero-pad"),i.$dialog.off(l).off(d),i.$element.focus()})),o&&(a=a||[],a.push(e),a.push(t),i.raise(o,a))},getHtmlContent:function(e){var t=this,n=t.exportPrependCssJs;return"<html>\n<head>\n"+t.getLayout("htmlMeta")+t.getLayout("exportCssJs").replace("{EXPORT_PREPEND_CSS_JS}",n)+"\n</head>\n<body>\n"+e+"\n</body>\n</html>"},exportData:function(e){var n,o,a,i=this,r=i.$element.val(),s=i.getTitle("exportText"),l=i.getTitle("exportHtml"),d=i.noDataMsg,c=i.noExportUrlMsg,u=i.today||new Date;
return t.isEmpty(r)||!t.isEmpty(i.exportUrl)&&i.hasInvalidConfig("export")?(o="exportText"===e?s:l,a=t.isEmpty(r)?d:c,void i.showPopupAlert(o,a,"errorExport",[e])):(r=i.getLayout("exportHeader").replace("{TODAY}",u).replace("{CREDITS}",t.CREDITS_MD)+r,"exportHtml"!==e?void i.download("exportText",r):(n=t.parseHtml(i.generatePreview(r,!0)),void i.download("exportHtml",i.getHtmlContent(n))))},renderIcon:function(e){var n=this;return n.getConfig("icons",e)||t.EMPTY},render:function(){var n,o=this,a=o.$element,i=t.create("div").addClass("md-container"),r=o.getLayout("main"),s="md-editor-input-temporary",l=a.attr("id")+"-container";return r?(o.theme&&t.addCss(i,"theme-"+o.theme),n=r.replace("{INPUT}",'<div class="'+s+'"></div>').replace("{HEADER}",o.renderHeader()).replace("{FOOTER}",o.renderFooter()).replace("{PREVIEW}",o.getLayout("preview")).replace("{DIALOG}",o.getLayout("dialog")),i.attr("id",l).insertBefore(a).html(n),i.find("."+s).before(a).remove(),t.addCss(a,o.inputCss),o.$container=i,o.$editor=i.find(".md-editor"),o.$preview=i.find(".md-preview"),o.$btnPreview=i.find(".md-btn-preview"),o.$btnUndo=i.find(".md-btn-undo"),o.$btnRedo=i.find(".md-btn-redo"),o.$dialog=i.find(".md-dialog"),o.$dialogHeadTitle=o.$dialog.find(".md-dialog-head-title"),o.$dialogInput=o.$dialog.find(".md-dialog-input"),o.$dialogTitle=o.$dialog.find(".md-dialog-title"),o.$dialogContent=o.$dialog.find(".md-dialog-content"),o.$dialogCancel=o.$dialog.find(".md-dialog-cancel"),o.$dialogSubmit=o.$dialog.find(".md-dialog-submit"),o.$dialogClose=o.$dialog.find(".close"),o.$dialogMain=o.$dialog.find(".modal-dialog"),o.$dialogHeader=o.$dialog.find(".modal-header"),o.$dialogFooter=o.$dialog.find(".modal-footer"),o.$mode=i.find(".md-btn-mode"),o.$modeInput=o.$mode.find('input:radio[name="mdMode"]'),o.$inputPreview=i.find(".md-input-preview"),o.$inputCell=i.find(".md-input-cell"),o.$previewCell=i.find(".md-preview-cell"),o.previewModeTitle&&o.$editor.find(".md-toolbar-header-l").prepend('<div class="md-preview-mode-title">'+o.previewModeTitle+"</div>"),"preview"===o.defaultMode||o.enableSplitMode&&"split"===o.defaultMode||(o.defaultMode="editor"),o.currentMode=o.defaultMode,t.addCss(o.$inputPreview,"md-"+o.defaultMode+"-mode"),void e.each(o.dropUp,function(e,t){t&&i.find('button[data-key="'+e+'"]').parent().addClass("dropup")})):t.EMPTY},initToolbar:function(){var t=this,n=["toolbarHeaderL","toolbarHeaderR","toolbarFooterL","toolbarFooterR"];e.each(n,function(n,a){void 0!==t[a]&&e.isArray(t[a])||(t[a]=o.toolbar[a])})},getButtons:function(t){var n=this,o=[];return e.each(n[t],function(t,n){var a=e.isArray(n)?n:[n];e.merge(o,a)}),o},getValidButtons:function(){var t=this,n=t.getButtons("toolbarHeaderL");return e.merge(n,t.getButtons("toolbarHeaderR")),e.merge(n,t.getButtons("toolbarFooterL")),e.merge(n,t.getButtons("toolbarFooterR")),n},renderHint:function(){var n,o,a,i,r,s,l=this,d="{ACCESS_KEYS}";return n=l.getLayout("hint").replace("{LINK_CM}",t.LINK_CM).replace("{LINK_MI}",t.LINK_MI),-1===n.indexOf(d)?n:(o='<div class="md-hint-access-keys"><ul>',e.each(l.getValidButtons(),function(e,t){var n,d="emoji"===t&&!l.enableEmojies||l.hiddenActions.indexOf(t)>-1;if(!d)if(s=l.getConfig("buttonCss",t)||l.defaultButtonCss,"heading"===t)for(r=1;6>=r;r++)a=l.renderIcon("heading")+r,n=l.getConfig("buttonAccessKeys",t+r),i=l.getConfig("buttonTitles","heading")+" "+r,o+='<li title="'+i+'"><p><span class="'+s+'">'+a+"</span></p><p><kbd>ALT</kbd> &ndash; <kbd>"+n+"</kbd></p></li>";else"export"!==t.substring(0,6)&&"mode"!==t.substring(0,4)&&(n=l.getConfig("buttonAccessKeys",t),a=l.renderIcon(t),i=l.getConfig("buttonTitles",t),o+='<li title="'+i+'"><p><span class="'+s+'">'+a+"</span></p><p><kbd>ALT</kbd> &ndash; <kbd>"+n+"</kbd></p></li>")}),o+="</ul></div>",n.replace(d,o))},renderHeader:function(){var e=this,t=e.getLayout("header");return t=e.renderToolbar(t,"toolbarHeaderL"),t=e.renderToolbar(t,"toolbarHeaderR")},renderFooter:function(){var e=this,t=e.getLayout("footer");return t=e.renderToolbar(t,"toolbarFooterL"),t=e.renderToolbar(t,"toolbarFooterR")},renderToolbar:function(t,n){var o,a,i,r=this,s=n.toUpperCase(),l="",d="";return o="{"+s.substring(0,7)+"_"+s.substring(7,13)+"_"+s.substring(13,14)+"}",-1===t.indexOf(o)?t:(e.each(r[n],function(t,n){e.isArray(n)||(n=[n]),i="",e.each(n,function(e,t){a=r.getConfig("buttonGroupCss",t)||r.defaultButtonGroupCss,i+=r.renderButton(t)+"\n",r.isPreviewModeButton(t)&&(a+=" md-always-visible"),"mode"===t&&(a+=" btn-group-toggle md-btn-mode",d=' data-toggle="buttons"')}),l+='<div class="'+a+'" role="group"'+d+">\n"+i+"</div>\n"}),t.replace(o,l))},getFileName:function(e){var t=this,n=t.exportFileName,o=t.getConfig("exportConfig",e),a=o&&o.ext||"";return a?n+"."+a:n},renderMenuItem:function(e,n){var o,a,i,r=this,s=t.create("div"),l=e+n;return"export"===e?(a=r.getConfig("buttonTitles",l),i=r.getLabel(l)):(a=r.getConfig("buttonTitles",e),i=a+" "+n),o=t.create("a",{href:"#","class":"dropdown-item md-btn-"+e+" md-btn-"+l,title:a,accesskey:r.getConfig("buttonAccessKeys",l),"data-key":l}).html(i),i=s.append(o).html(),s.remove(),r.isBs4?i:"<li>"+i+"</li>"},getEmojies:function(){var n=this,o="";return!n.enableEmojies||t.isEmpty(window.mdEmojies)?"":(o='<li class="md-emoji-search"><span class="md-close">&times;</span><input type="text" class="form-control form-control-sm input-sm" placeholder="'+n.emojiSearchHint+'"></li>',e.each(window.mdEmojies,function(e,a){var i,r,s=":"+t.htmlEncode(e)+":",l=window.mdEmojiesShortcuts[e]||"";if(l)for(s+=" or ",i=0;i<l.length;i++)r=t.htmlEncode(l[i]),s+=0===i?r:" or "+r;o+='<li><a href="#" class="md-btn-emoji" title="'+s+'" data-key="'+e+'"><span class="md-emoji">'+(n.useTwemoji?window.twemoji.parse(a):a)+"</span></a></li>"}),o)},getModeButton:function(e){var t=this,n=t.getConfig("buttonCss",e)||t.defaultButtonCss||"",o="",a=e.substr(4).toLowerCase(),i=t.getConfig("buttonAccessKeys",e)||"";return t.defaultMode===a&&(n+=" active",o=" checked"),'<label class="'+n+'" title="'+t.getConfig("buttonTitles",e)+'"><input type="radio" value="'+e+'" name="mdMode" autocomplete="off" accesskey="'+i+'"'+o+">"+t.renderIcon(e)+"</label>"},renderButton:function(e){var n,o,a,i,r,s,l,d,c,u,f=this,a=f.getConfig("icons",e),p="md-btn-"+e,m=f.getConfig("dropdownCss",e),h="mode"===e||void 0!==a||void 0!==f.getConfig("buttonActions",e),g="emoji"===e&&!f.enableEmojies||f.hiddenActions.indexOf(e)>-1,v=f.isBs4&&"emoji"!==e?"div":"ul";if(!h||g||!f.enableUndoRedo&&("undo"===e||"redo"===e||"editor"===e))return t.EMPTY;switch(c=f.getConfig("buttonCss",e)||f.defaultButtonCss,o=t.create("div"),n=t.create("button",{type:"button","data-key":e}),f.disableButton(n,f.isDisabled&&!f.isPreviewModeButton(e)),a=f.renderIcon(e),i=f.getConfig("buttonTitles",e)||t.EMPTY,r=f.getConfig("buttonLabels",e)||t.EMPTY,i&&n.attr("title",i),"fullscreen"===e&&(a='<span class="md-max-icon">'+a+'</span><span class="md-min-icon">'+f.renderIcon("minscreen")+"</span>"),r=a&&r?a+" "+r:a+r,o.append(n),e){case"emoji":case"export":case"heading":if(n.html(r+" ").attr({"data-toggle":"dropdown"}).append('<span class="caret"></span>').addClass(c+" dropdown-toggle"),u=m?"dropdown-menu "+m:"dropdown-menu",d="<"+v+' class="'+u+'">\n',"heading"===e)for(l=1;7>l;l++)s=i+" "+l,d+=f.renderMenuItem("heading",l);else d+="emoji"===e?f.getEmojies():f.renderMenuItem(e,"Html")+f.renderMenuItem(e,"Text");return d+="</"+v+">",o.append(d),o.html();case"mode":return f.getModeButton("modeEditor")+f.getModeButton("modePreview")+(f.enableSplitMode?f.getModeButton("modeSplit"):"");default:return n.attr("accesskey",f.getConfig("buttonAccessKeys",e)).html(r).addClass(c+" "+p+" md-btn"),o.html()}},_mergeAjaxCallback:function(e,t){var n=this,o=n._ajaxSettings,a=n.mergeAjaxCallbacks,i=o[e];a&&"function"==typeof i?"before"===a?o[e]=function(){i.apply(this,arguments),t.apply(this,arguments)}:o[e]=function(){t.apply(this,arguments),i.apply(this,arguments)}:o[e]=t},_ajaxSubmit:function(t){var n,o,a,i,r,s=this,l=s.ajaxParserErrorMsg,d=s.getTitle("exportHtml");n=function(e){s.raise("beforeExportHtm",[e])&&s.showPopup(d,s.getProgress(s.ajaxParserProgressMsg))},o=function(e,t,n){s.$dialog.modal("hide"),e?(r=s.getPureHtml(e),s.download("exportHtml",s.getHtmlContent(r)),s.raise("successExportHtm",[e,t,n])):s.showPopupAlert(d,l,"errorExportHtm",[e,t,n])},a=function(e,t,n){s.showPopupAlert(d,l,"exceptionExportHtm",[e,t,n])},s._ajaxSettings=e.extend(!0,{},s.ajaxSettings),s._mergeAjaxCallback("beforeSend",n),s._mergeAjaxCallback("success",o),s._mergeAjaxCallback("error",a),i=e.extend(!0,{},{type:"POST",url:s.parserUrl,data:{source:t}},s._ajaxSettings),e.ajax(i)}},e.fn.markdownEditor=function(n){var o=Array.apply(null,arguments),a=[];switch(o.shift(),this.each(function(){var i,s=e(this),l=s.data("markdownEditor"),d="object"==typeof n&&n,c=d.theme||s.data("theme"),u={},f={},p=d.language||s.data("language")||e.fn.markdownEditor.defaults.language||"en";l||(c&&(f=e.fn.markdownEditorThemes[c]||{}),"en"===p||t.isEmpty(e.fn.markdownEditorLocales[p])||(u=e.fn.markdownEditorLocales[p]||{}),i=e.extend(!0,{},e.fn.markdownEditor.defaults,f,e.fn.markdownEditorLocales.en,u,d,s.data()),l=new r(this,i),s.data("markdownEditor",l)),"string"==typeof n&&a.push(l[n].apply(l,o))}),a.length){case 0:return this;case 1:return a[0];default:return a}},e.fn.markdownEditor.defaults={language:"en",theme:null,bsVersion:t.BS4_VER,defaultMode:"editor",enableUndoRedo:!0,enableSplitMode:!0,enableLivePreview:void 0,enableScrollSync:!0,startFullScreen:!1,enableEmojies:!0,useTwemoji:!1,purifyHtml:!0,showAlerts:!0,enableEscKeyFullScreen:!0,toolbarHeaderL:void 0,toolbarHeaderR:void 0,toolbarFooterL:void 0,toolbarFooterR:void 0,exportPrependCssJs:void 0,hiddenActions:[],dropUp:{"export":!0},parserUrl:t.EMPTY,parserMethod:void 0,ajaxSettings:{},ajaxMergeCallbacks:!0,markdownItOptions:{html:!1,xhtmlOut:!0,breaks:!0,linkify:!0,typographer:!0,highlight:function(e){return window.hljs?window.hljs.highlightAuto(e).value:e}},markdownItDisabledRules:[],markdownItPlugins:{markdownitDeflist:{},markdownitFootnote:{},markdownitAbbr:{},markdownitEmoji:{},markdownitSub:{},markdownitSup:{},markdownitMark:{},markdownitIns:{},markdownitSmartArrows:{},markdownitCheckbox:{divWrap:!0,divClass:"form-check checkbox",idPrefix:"cbx_"},markdownitCjkBreaks:{}},exportUrl:t.EMPTY,exportUrlMethod:"post",exportUrlAddlData:t.EMPTY,today:t.EMPTY,alertFadeDuration:2e3,outputParseTimeout:18e5,exportConfig:o.exportConfig,templates:{},inputCss:"md-input",alertMsgCss:"alert alert-danger",defaultButtonCss:"btn btn-default btn-outline-secondary",defaultButtonGroupCss:"btn-group md-btn-group",previewModeButtons:["hint","fullscreen","mode","export"],buttonCss:{},buttonGroupCss:{},buttonAccessKeys:{},dropdownCss:{},icons:{},postProcess:{"<table>":'<table class="table table-bordered table-striped">',"<pre>":'<pre class="md-codeblock">',"<blockquote>":'<blockquote class="blockquote md-blockquote">','<input type="checkbox"':'<input type="checkbox" class="form-check-input"','<label for="cbx':'<label class="form-check-label" for="cbx'}},e.fn.markdownEditorLocales.en={ajaxParserErrorMsg:"Error parsing markdown text. Please try again later.",ajaxParserProgressMsg:"Parsing markdown text ...",noDataMsg:"No valid source data found!",exportFileName:"export",buttonTitles:{},buttonLabels:{},buttonPrompts:{},buttonActions:{},templates:{},dialogCancelText:"Cancel",dialogSubmitText:"Submit",previewErrorTitle:"Preview Error",previewModeTitle:"Preview Mode",previewProgressMsg:"Generating preview ...",noPreviewUrlMsg:"Markdown preview processor unavailable. Please contact the system administrator.",noExportUrlMsg:"Export processor unavailable. Please contact the system administrator.",emojiSearchHint:"Search emojis ...",loadingMsg:"Loading ..."},e.fn.markdownEditor.Constructor=r,e(document).ready(function(){var t=e("textarea.markdown");t.length&&t.markdownEditor()})});